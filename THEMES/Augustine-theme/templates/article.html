<!-- 
_______________________________________________________________________________

                                CONTENU DES ARTICLES
_______________________________________________________________________________

Description :
-------------
Cette page du template génère le contenu des articles.
-->

{% extends "base.html" %}

{% block html_lang %}{{ article.lang }}{% endblock %}

{% block head -%}
    {{ super() -}}

    {% if article.summary %}
        <meta name="description" content="{{ article.summary | striptags | safe | truncate(150) }}" />
    {% endif %}
{% endblock %}

{% block title %}{{ article.title|striptags }}{% endblock %}

{% block extra_head %}
    {% import 'translations.html' as translations with context %}
    {% if translations.entry_hreflang(article) %}
        {{ translations.entry_hreflang(article) }}
    {% endif %}
{% endblock %}


<!-- CONTENU SOUS-EN-TETE : -->
{% block contenu_sous_tete %}
    <div class="container text-light py-1 small">
        <span><i class="bi bi-folder-fill me-2 text-warning"></i><b class="text-warning">Catégorie : </b></span>
        <a href="{{ SITEURL }}/{{ article.category.url }}" title="Voir tous les articles de la catégorie" class="text-light">{{ article.category }}</a>
        <i class="bi bi-arrow-bar-right"></i>
        <span><i class="bi bi-feather me-2 text-warning"></i><b class="text-warning">Article : </b></span>{{ article.title }}        
    </div>
{% endblock %}


<!-- CONTENU DE L'ARTICLE : -->
{% block content %}
    <section>
        <article class="mt-5 border rounded-4 shadow">

            <!-- ENTETE DE L'ARTICLE : -->
            <header class="row m-0 ps-2 pt-2 pb-2 fw-bold text-capitalize rounded-top-4 bg-dark">         

                <!-- Titre de l'article : -->
                <div class="fs-4 col-10 text-white">
                    <i class="bi bi-feather me-2 text-warning"></i>
                    {{ article.title }}
                </div>

                <!-- Bouton de copie du lien de l'article : -->
                <div class="col-2 text-end align-self-center">
                    <button id="btn-copyLink-{{ article.url }}"
                    type="button"
                    class="btn btn-warning"
                    style="max-width: 2.8em"
                    title="Copier l'URL de l'article : {{ SITEURL }}/{{ article.url }}">                    
                        <i class="bi bi-share-fill"></i>
                    </button>

                    <!-- Script pour copier le lien de l'article dans le presse papier : -->
                    <script>
                        document.getElementById("btn-copyLink-{{ article.url }}").addEventListener("click", async function() {
                            try {
                                // Utiliser l'API Clipboard pour copier l'URL
                                await navigator.clipboard.writeText("{{ SITEURL }}/{{ article.url }}");
                                // Afficher une alerte pour confirmer la copie
                                //alert("L'URL a été copiée dans le presse-papiers !");
                            } catch (err) {
                                console.error('Échec de la copie : ', err);
                            }
                        });
                    </script>
                </div>
            </header>

            
            <div class="m-0 p-4 bg-body-tertiary article-contenu">
                {{ article.content }}
            </div>

            
            <!-- INFORMATION SUR L'ARTICLE : -->
            <div class="m-0  ps-3 bg-dark small rounded-bottom-4">
                {% include 'article_infos.html' %}
            </div>

        </article>


        <!-- Script pour afficher le contenu la propriété ALT sous les images : -->
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                document.querySelectorAll('.article-contenu img').forEach(function(img) {
                    const altText = img.getAttribute('alt');
                    const caption = document.createElement('div');
                    caption.className = 'alt-img';
                    caption.textContent = altText;
                    img.parentNode.appendChild(caption);
                });
            });  
        </script>

        <!-- COMMENTAIRES DISQUS DE L'ARTICLE :  -->
        {% if DISQUS_SITENAME and SITEURL and article.status != "draft" %}
        <div class="comments">
            <h2>Comments !</h2>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = '{{ DISQUS_SITENAME }}';
                var disqus_identifier = '{{ article.url }}';
                var disqus_url = '{{ SITEURL }}/{{ article.url }}';
                (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//{{ DISQUS_SITENAME }}.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    {% endif %}   

    </section>

{% endblock %}

<!-- NAVBAR DE PIED : -->
{% block bottom_nav_bar %}

    <nav class="container text-center p-0">
        <div class="row">
            <a class="col-6 btn btn-dark text-warning fs-3"
            title="Retour à l'accueil"
            href="{{ SITEURL }}">
                <i class="bi bi-house-up"></i>
            </a>
            <a class="col-6 btn btn-dark text-warning fs-3"
            title="Retour haut de page"
            href="#">
                <i class="bi bi-chevron-bar-up"></i>
            </a>
        </div>

    </nav>

{% endblock %}